<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="format-detection" content="telephone=no" />
    <title>ุงุฎุชุจุงุฑุงุช ุจูุฑูุฒ ุงูุฏูููุฉ</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&amp;display=swap"
      rel="stylesheet"
    />
    <script src="/_sdk/data_sdk.js"></script>
    <script src="/_sdk/element_sdk.js"></script>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" href="../images&video/pirls.png" type="image/png" />
    <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-LJJ4F5EFRW"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-LJJ4F5EFRW");
    </script>
  </head>
  <body data-page="home">
    <nav class="main-nav" aria-label="ุดุฑูุท ุงูุชููู">
      <div class="nav-brand">
        <a class="nav-logo" href="#homePage" data-page="home">
          <span class="brand-mark" aria-hidden="true">๏ดพ๏ดฟ</span>
          <span class="brand-text">ุงุฎุชุจุงุฑุงุช ุจูุฑูุฒ</span>
        </a>
      </div>
      <button
        class="nav-toggle"
        type="button"
        aria-expanded="false"
        aria-controls="navLinks"
      >
        <span class="sr-only">ุชุจุฏูู ูุงุฆูุฉ ุงูุชููู</span>
        <span class="nav-toggle-bar"></span>
        <span class="nav-toggle-bar"></span>
        <span class="nav-toggle-bar"></span>
      </button>
      <ul id="navLinks" class="nav-links">
        <li class="nav-item">
          <a class="nav-link" data-page="home" href="#homePage">
            <span class="nav-icon" aria-hidden="true">๐</span>
            <span class="nav-label">ุงูุฑุฆูุณูุฉ</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#contact">
            <span class="nav-icon" aria-hidden="true">โ๏ธ</span>
            <span class="nav-label">ุงุชุตู ุจูุง</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="dashboard.html" id="profileLink">
            <span class="nav-icon" aria-hidden="true">๐๐ปโโ๏ธ</span>
            <span class="nav-label">ุงูููู ุงูุดุฎุตู</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="login.html">
            <span class="nav-icon" aria-hidden="true">๐</span>
            <span class="nav-label">ุชุณุฌูู ุงูุฏุฎูู</span>
          </a>
        </li>
      </ul>
      <div class="theme-toggle-container">
        <button id="themeToggle" class="theme-toggle-btn" title="ุชุจุฏูู ุงูุซูู">
          <span class="theme-icon">๐</span>
        </button>
      </div>
    </nav>

    <div class="container page-container active-container">
      <section id="homePage" class="page active home-page" data-page="home">
        <header class="page-header">
          <h1 id="schoolName">ูุฏุฑุณุฉ ุงูุทุงูุจ ุงูุฐูู ุงูุฎุงุตุฉ ุจูุฒูู</h1>
          <p id="welcomeText" class="page-subtitle">
            ูุฑุญุจุงู ุจู ูู ููุตุฉ ุงุฎุชุจุงุฑุงุช ุจูุฑูุฒ
          </p>
          <p class="page-meta">ูุจุงุฏุฑุฉ ุฅุนุฏุงุฏ ุตูุงุบุฉ ุฃุณุฆูุฉ ุจูุฑูุฒ</p>
        </header>

        <div class="hero-search" role="search">
          <input
            type="text"
            class="search-input"
            placeholder="ุงุจุญุซ ูู ุฃุณุฆูุฉ ุจูุฑูุฒ ูุงูุฃุฏูุงุช ุงูุชุนููููุฉ"
            aria-label="ุจุญุซ"
          />
          <button type="button" class="btn btn-search">ุจุญุซ</button>
        </div>

        <section class="hero-card">
          <h2>ููุตุฉ ุงุฎุชุจุงุฑ ุญุฏูุซุฉ ูุณุชูุญุงุฉ ูู ุงูุชุตููู ุงูุชุฑุจูู ุงูุญุฏูุซ</h2>
          <p>
            ุงูุทูู ูู ุชุฌุฑุจุฉ ุชูููู ูุฑูุญุฉ ููุทูุงุจุ ูุน ุชุตููู ุนุตุฑู ูุฎูุงุฑุงุช ูุชุนุฏุฏุฉ
            ูููุณุชูููู .
          </p>
          <div class="hero-actions">
            <a class="btn btn-primary" href="#examForm">ุจุฏุก ุงุฎุชุจุงุฑ ุฌุฏูุฏ</a>
            <a
              class="btn btn-ghost nav-link"
              data-page="results"
              href="#resultsPage"
              >ูุดุงูุฏุฉ ุขุฎุฑ ุงููุชุงุฆุฌ</a
            >
          </div>
        </section>

        <section class="home-form-card" id="examForm">
          <h3>ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ</h3>
          <p class="home-form-note">
            ุงููุฃ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ูุจุฏุก ุงูุงุฎุชุจุงุฑุ ูููููู ุงูุนูุฏุฉ ูู ุฃู ููุช
            ูุฅููุงูู.
          </p>
          <div class="home-form-grid">
            <div class="form-group">
              <label for="studentName">ุงุณู ุงูุทุงูุจ</label>
              <input
                type="text"
                id="studentName"
                placeholder="ุฃุฏุฎู ุงุณูู ุงููุงูู"
              />
            </div>
            <div class="form-group">
              <label for="gradeLevel">ุงูุตู</label>
              <input
                type="text"
                id="gradeLevel"
                placeholder="ุฃุฏุฎู ุงูุตู ุงูุฏุฑุงุณู"
              />
            </div>
            <div class="form-group">
              <label for="recipientEmail"
                >ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุงุณุชูุงู ุงููุชูุฌุฉ</label
              >
              <input
                type="email"
                id="recipientEmail"
                value="kamel.fawwzia333@gmail.com"
                disabled
              />
            </div>
            <div class="form-group">
              <label for="levelSelect">ุงูููุฑุฉ</label>
              <select id="levelSelect">
                <option value="">ุงุฎุชุฑ ุงูููุฑุฉ</option>
                <option value="ูููุฉ ูุง ุชุตุฏู">ูููุฉ ูุง ุชุตุฏู</option>
                <option value="ูุทุนุฉ ุงูุตูุตุงู ุงูุตุบูุฑุฉ">
                  ูุทุนุฉ ุงูุตูุตุงู ุงูุตุบูุฑุฉ
                </option>
                <option value="ุญูู ุฃููุง ุงููุณุฑ ุญูู">ุญูู ุฃููุง ุงููุณุฑ ุญูู</option>
                <option value="ุณูุฑูู ุงูุณููููู ุงูุนูููููุงููุฉู">ุณูุฑูู ุงูุณููููู ุงูุนูููููุงููุฉู</option>
              </select>
            </div>
            <div class="form-group">
              <label for="durationSelect">ูุฏุฉ ุงูุงุฎุชุจุงุฑ (ุฏูููุฉ)</label>
              <select id="durationSelect">
                <option value="0">ุจุฏูู ุชูููุช</option>
                <option value="15">15 ุฏูููุฉ</option>
                <option value="30">30 ุฏูููุฉ</option>
                <option value="45">45 ุฏูููุฉ</option>
                <option value="60">60 ุฏูููุฉ</option>
              </select>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn btn-primary" id="continueBtn" disabled>
              ูุชุงุจุนุฉ
            </button>
          </div>
        </section>
      </section>
    </div>

    <div class="container page-container">
      <section id="rulesPage" class="page" data-page="rules">
        <div class="header">
          <h1 id="instructionsTitle">ููุงุนุฏ ุงูุงุฎุชุจุงุฑ</h1>
        </div>
        <div class="rules-list">
          <ul>
            <li>ุงูุฑุฃ ูู ุณุคุงู ุจุนูุงูุฉ ูุจู ุงุฎุชูุงุฑ ุงูุฅุฌุงุจุฉ</li>
            <li>ููููู ุงูุชููู ุจูู ุงูุฃุณุฆูุฉ ุจุงุณุชุฎุฏุงู ุฃุฒุฑุงุฑ ุงูุณุงุจู ูุงูุชุงูู</li>
            <li>ููููู ุญูุธ ุชูุฏูู ูุงูุนูุฏุฉ ูุงุญูุงู</li>
            <li>ุชุฃูุฏ ูู ุงูุฅุฌุงุจุฉ ุนูู ุฌููุน ุงูุฃุณุฆูุฉ ูุจู ุฅููุงุก ุงูุงุฎุชุจุงุฑ</li>
            <li>ุณูุชู ุนุฑุถ ุงููุชูุฌุฉ ููุฑ ุงูุชูุงุก ุงูุงุฎุชุจุงุฑ</li>
            <li>ููููู ุทุจุงุนุฉ ุงููุชูุฌุฉ ุฃู ุชุญููููุง ูููู PDF</li>
          </ul>
        </div>
        <div id="testInfo" class="card-surface">
          <p><strong>ุงูููุฑุฉ:</strong> <span id="selectedLevel"></span></p>
          <p><strong>ุงููุฏุฉ:</strong> <span id="selectedDuration"></span></p>
          <p><strong>ุนุฏุฏ ุงูุฃุณุฆูุฉ:</strong> <span id="totalQuestions"></span></p>
        </div>
        <div class="btn-group">
          <button class="btn btn-secondary" id="backToHomeBtn">ุฑุฌูุน</button>
          <button class="btn" id="startTestBtn">ุงุจุฏุฃ ุงูุงุฎุชุจุงุฑ</button>
        </div>
      </section>
    </div>

    <div class="container page-container">
      <section id="testPage" class="page" data-page="test">
        <div class="header">
          <h1>ุงูุงุฎุชุจุงุฑ</h1>
        </div>
        <div id="timerContainer" class="timer">
          ุงูููุช ุงููุชุจูู: <span id="timeRemaining"></span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
        <p class="question-progress">
          ุงูุณุคุงู <span id="currentQuestion">1</span> ูู
          <span id="totalQuestionsTest"></span>
        </p>
        <div class="question-container">
          <div class="question-header">
            <div class="question-number" id="questionNumber"></div>
            <div class="question-text" id="questionText"></div>
          </div>
          <div class="options-container" id="optionsContainer"></div>
          <div id="answerNote" class="answer-status" style="display: none">
            <p>โ ุชู ุญูุธ ุฅุฌุงุจุชู</p>
          </div>
        </div>
        <div class="btn-group">
          <button class="btn btn-secondary" id="prevBtn" disabled>
            ุงูุณุงุจู
          </button>
          <button class="btn btn-secondary" id="saveProgressBtn">
            ุญูุธ ูุงูุฎุฑูุฌ
          </button>
          <button class="btn" id="nextBtn">ุงูุชุงูู</button>
          <button class="btn" id="finishBtn" style="display: none">
            ุฅููุงุก ุงูุงุฎุชุจุงุฑ
          </button>
        </div>
        <div
          class="btn-group"
          style="margin-top: 15px; justify-content: flex-start"
        >
          <button
            class="btn btn-secondary"
            id="showTextBtn"
            style="display: none"
          >
            ุนุฑุถ ุงููุต
          </button>
        </div>
      </section>
    </div>

    <div class="container">
      <section id="resultsPage" class="page" data-page="results">
        <div class="header">
          <h1 id="resultsTitle">ูุชูุฌุฉ ุงูุงุฎุชุจุงุฑ</h1>
        </div>
        <div class="results-summary">
          <div class="score-circle">
            <div class="percentage" id="scorePercentage">0%</div>
            <div class="label">ุงููุชูุฌุฉ</div>
          </div>
          <div class="stats-grid">
            <div class="stat-card">
              <div class="number" id="correctCount">0</div>
              <div class="label">ุฅุฌุงุจุงุช ุตุญูุญุฉ</div>
            </div>
            <div class="stat-card">
              <div class="number" id="incorrectCount">0</div>
              <div class="label">ุฅุฌุงุจุงุช ุฎุงุทุฆุฉ</div>
            </div>
            <div class="stat-card">
              <div class="number" id="timeSpent">0</div>
              <div class="label">ุงูููุช ุงููุณุชุบุฑู</div>
            </div>
          </div>
        </div>
        <div class="answer-review">
          <h2 class="review-title">ูุฑุงุฌุนุฉ ุงูุฅุฌุงุจุงุช</h2>
          <div id="reviewContainer"></div>
        </div>
        <div class="resources">
          <h3>ูุตุงุฏุฑ ูููุฑุงุฌุนุฉ</h3>
          <a
            href="#"
            class="resource-link"
            target="_blank"
            rel="noopener noreferrer"
            >๐ ููุฎุต ุงูุฏุฑูุณ - ููู PDF</a
          >
          <a
            href="#"
            class="resource-link"
            target="_blank"
            rel="noopener noreferrer"
            >๐ ุดุฑุญ ุชูุตููู - ุตูุญุฉ ูุงููุง</a
          >
          <a
            href="#"
            class="resource-link"
            target="_blank"
            rel="noopener noreferrer"
            >๐ฅ ููุฏูููุงุช ุชุนููููุฉ</a
          >
          <a
            href="#"
            class="resource-link"
            target="_blank"
            rel="noopener noreferrer"
            >๐ ุชูุงุฑูู ุฅุถุงููุฉ</a
          >
        </div>
        <div class="btn-group">
          <button class="btn" id="sendResultBtn">ุฅุฑุณุงู ุงููุชูุฌุฉ</button>
          <button class="btn btn-secondary" id="printResultBtn">
            ุทุจุงุนุฉ ุงููุชูุฌุฉ
          </button>
          <button class="btn" id="newTestBtn">ุงุฎุชุจุงุฑ ุฌุฏูุฏ</button>
        </div>
      </section>
    </div>

    <script type="module">
      import { auth, db } from "./firebase.js";
      import {
        collection,
        addDoc,
        serverTimestamp,
      } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";
      import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

      onAuthStateChanged(auth, (user) => {
        const link = document.getElementById("profileLink");
        if (link) {
          if (!user) {
            link.href = "login.html";
          } else if (user.email === "kamel.fawwzia333@gmail.com") {
            link.href = "admin.html";
          } else {
            link.href = "dashboard.html";
          }
        }
      });

      window.saveTestResult = async function (result) {
        try {
          const user = auth.currentUser;
          if (!user) {
            return;
          }
          await addDoc(collection(db, "results"), {
            uid: user.uid,
            studentName: result.studentName || "",
            subject: result.subject || "",
            level: result.level || "",
            scorePercentage:
              typeof result.scorePercentage === "number"
                ? result.scorePercentage
                : null,
            correctCount:
              typeof result.correctCount === "number"
                ? result.correctCount
                : null,
            incorrectCount:
              typeof result.incorrectCount === "number"
                ? result.incorrectCount
                : null,
            timeSpentSeconds:
              typeof result.timeSpentSeconds === "number"
                ? result.timeSpentSeconds
                : null,
            createdAt: serverTimestamp(),
          });
        } catch (e) {
          console.error("Failed to save result", e);
        }
      };
    </script>

    <script src="script.js"></script>
  </body>
</html>
